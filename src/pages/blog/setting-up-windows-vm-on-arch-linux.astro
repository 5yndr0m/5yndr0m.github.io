---
import Layout from "../../layouts/Layout.astro";
import { ArrowLeft, Calendar, Tag, Clock } from "lucide-react";
---

<Layout title="Setting Up a Windows VM on Arch Linux | Syndrom">
    <article class="max-w-4xl mx-auto px-4 py-12 sm:px-6 lg:px-8">
        <a href="/blog" class="inline-flex items-center text-slate-400 hover:text-mainPurple mb-8 transition-colors group">
            <ArrowLeft className="w-4 h-4 mr-2 group-hover:-translate-x-1 transition-transform" />
            Back to Blog
        </a>

        <header class="mb-12 text-center">
            <div class="flex flex-wrap items-center justify-center gap-2 mb-6 text-sm">
                <span class="bg-mainPurple/20 text-mainLavender px-3 py-1 rounded-full font-medium border border-mainPurple/20">Guide</span>
                <span class="text-white/20">•</span>
                <span class="text-slate-500 flex items-center"><Calendar className="w-4 h-4 mr-1 text-mainPurple" /> Aug 1, 2025</span>
                <span class="text-white/20">•</span>
                <span class="text-slate-500 flex items-center"><Clock className="w-4 h-4 mr-1 text-mainPurple" /> 10 min read</span>
            </div>

            <h1 class="text-3xl md:text-6xl font-extrabold text-white mb-8 tracking-tight leading-tight">
                Setting Up a Windows VM on <span class="text-mainPurple">Arch Linux</span>
            </h1>

            <div class="relative w-full aspect-video rounded-3xl overflow-hidden shadow-[0_0_50px_rgba(147,51,234,0.1)] border border-white/5 mb-12 bg-surface">
                <div class="absolute inset-0 flex items-center justify-center bg-muted text-white/10 uppercase tracking-tighter text-3xl font-black italic">
                    Cover Image Placeholder
                </div>
            </div>
        </header>

        <div class="prose prose-lg prose-invert max-w-none prose-headings:text-mainLavender prose-a:text-mainPurple hover:prose-a:text-mainGreen prose-strong:text-mainGreen prose-code:text-mainGreen prose-code:bg-muted prose-code:px-1 prose-code:rounded prose-pre:bg-muted prose-pre:border prose-pre:border-white/5">
            <p>
                Running Windows in a virtual machine on Arch Linux is straightforward with QEMU/KVM and
                virt-manager. This guide walks you through creating a Windows VM with optimized
                performance using VirtIO drivers.
            </p>

            <h2>Step 1: Download Windows ISO</h2>
            <p>
                First, you'll need a Windows installation image. Visit Microsoft's official website to
                download the Windows 10 or Windows 11 ISO. If you have a Windows license, you can use the
                Media Creation Tool. Save the ISO file somewhere accessible, like <code>/home/syndrom/Downloads/</code>.
            </p>

            <h2>Step 2: Download VirtIO Drivers</h2>
            <p>
                Windows needs special drivers for optimal performance with KVM. These VirtIO drivers
                significantly improve disk and network performance. Download them with:
            </p>
            <pre><code>{`# Download the latest stable VirtIO drivers ISO
wget https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/stable-virtio/virtio-win.iso -O ~/Downloads/virtio-win.iso`}</code></pre>

            <h2>Step 3: Create the Windows VM</h2>
            <p>
                Launch virt-manager and create a new virtual machine. Select "Local install media (ISO
                image or CDROM)" and click Forward. Browse to your Windows ISO file and let it
                automatically detect the operating system. If detection fails, manually select Microsoft
                Windows and your specific version.
            </p>
            <p>
                For memory and CPU settings, allocate at least 4GB of RAM (4096 MB) for Windows 10/11, and
                2-4 CPU cores depending on what your system can handle. Create a disk image of at least
                50GB, though more is recommended for a comfortable experience.
            </p>
            <p>
                On the final configuration screen, name your VM something like "Windows-10" and
                importantly, check "Customize configuration before install" before clicking Finish.
            </p>

            <h2>Step 4: Optimize VM Settings</h2>
            <p>
                The configuration window provides several optimization opportunities. In Boot Options,
                enable the boot menu and ensure the CD-ROM is first in the boot order.
            </p>
            <p>
                Add the VirtIO drivers by clicking "Add Hardware", selecting Storage, choosing "CDROM
                device", and browsing to the virtio-win.iso file you downloaded earlier.
            </p>
            <p>
                For better performance, change your network device model to "virtio" and your main disk
                bus to "VirtIO" (this requires loading drivers during Windows installation). Set the video
                model to "QXL" or "Virtio", and if you need audio, set the sound model to "ich9".
            </p>

            <h2>Step 5: Install Windows</h2>
            <p>
                Click "Begin Installation" to start the VM. It will boot from the Windows ISO. During
                installation, when you reach the disk selection screen, you might not see any drives
                initially. This is normal.
            </p>
            <p>
                Click "Load driver" and browse to the VirtIO CD-ROM. Navigate to <code>viostor/w10/amd64</code> (or the appropriate version for your Windows) and select
                the storage driver. Your disk should now appear, and you can continue with the normal
                Windows installation process.
            </p>

            <h2>Step 6: Install VirtIO Drivers (Post-installation)</h2>
            <p>
                After Windows boots for the first time, you need to install the remaining VirtIO drivers.
                Open File Explorer, navigate to the VirtIO CD-ROM, and run <code>virtio-win-gt-x64.msi</code>. This installs all the remaining drivers for optimal
                performance.
            </p>
            <p>
                I also recommend installing SPICE Guest Tools, which you can find at the SPICE project
                website or on the VirtIO CD-ROM at <code>guest-agent/qemu-ga-x86_64.msi</code>. This
                enables clipboard sharing, dynamic resolution adjustment, and better overall integration
                between host and guest.
            </p>

            <h2>Step 7: Optimize Performance</h2>
            <p>
                Within Windows, you can improve performance by disabling Windows Search indexing,
                unnecessary startup programs, and Windows Defender real-time protection if you don't need
                it. You can also disable visual effects through Control Panel → System → Advanced →
                Performance and select "Adjust for best performance".
            </p>
            <p>
                In the VM settings, allocate more RAM if you have it available and enable hardware
                acceleration if your CPU supports it.
            </p>

            <h2>Useful Tips</h2>
            <p>
                Take snapshots before making major changes using virt-manager. You can set up shared
                folders using SPICE WebDAV or Samba. USB devices can be passed through from the host to
                the VM when needed. Press Ctrl+Alt+F to toggle full screen mode in the VM viewer.
            </p>
            <p>
                With these settings, you should have a well-performing Windows VM running on your Arch
                Linux system!
            </p>
        </div>
    </article>
</Layout>
